SolutionDesign.md

## Shutdown behavior of nodes

A Consul node can <strong>auto-leave</strong> the quorum on shutdown, 
or can be <strong>manually removed</strong> from the quorum with the <strong>leave or force-leave</strong> commands 
<strong>run on the node you wish to remove</strong>.

Two parameters that affect the behavior of nodes in a cluster on shutdown and restart - both of which have “leave” in them.

<tt>leave_on_terminate</tt> - false by default. Setting this to true will remove the node from the cluster when it is terminated.

<tt>skip_leave_on_interrupt</tt> - false by default. Setting this to true will not remove the node from the cluster when it is interrupted. 
(see more on signals). 

A Consul node can be stopped via Unix signals. 
The behavior depends on how the nodes are notified i.e., which signal is passed to Consul.

Common kill signals and their impact on a running Consul process:

<table border="1" cellpadding="4" cellspacing="0">
<tr><th> Signal name</th><th>Signal value</th><th>Effect</th></tr>
<tr valign="top"><td>SIGHUP</td><td>1</td><td>Reloads Consul’s service configuration (some services like Checks, Services, Watches, HTTP Client Address and Log Levels)</td</tr>
<tr valign="top"><td>SIGINT</td><td>2</td><td>Usually generated by a Ctrl-c, for graceful shutdown by default</td</tr>
<tr valign="top"><td>SIGKILL</td><td>9</td><td>Non-graceful shutdown by default</td</tr>
<tr valign="top"><td>SIGTERM</td><td>15</td><td>Non-graceful shutdown by default</td</tr>
</table>

Here are the combinations of signals and configurations, with how Consul behaves:

<tt>leave_on_terminate false</tt> and <tt>skip_leave_on_interrupt false</tt>

   * On SIGTERM signal known peers list will not be affected.
   * On SIGINT(ctrl+c) signal known peers list will become null and the node will be deregistered from remaining nodes.
   <br /><br />

<tt>leave_on_terminate true</tt> and <tt>skip_leave_on_interrupt false</tt>

   * On SIGTERM signal known peers list will become null and the node will be deregistered from remaining nodes.
   * On SIGINT(ctrl+c) signal known peers list will become null and the node will be deregistered from remaining nodes.
   <br /><br />

<tt>leave_on_terminate true</tt> and <tt>skip_leave_on_interrupt true</tt>

   * On SIGTERM signal known peers list will become null and the node will be deregistered from remaining nodes.
   * On SIGINT(ctrl+c) signal known peers list will not be affected.
   <br /><br />

<tt>leave_on_terminate true</tt> and <tt>skip_leave_on_interrupt true</tt>

   * On SIGTERM signal known peers list will not be affected.
   * On SIGINT(ctrl+c) signal known peers list will not be affected.
   <br /><br />

Note that in case of a node failure (power failure or Consul kill signal), 
the known peers list will not be affected.???